#include "_itempid.fos"

import int GetSCEventProgress() from "event_sierra_caves";

//Random caves
#define ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL       (1)
#define ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1     (2)
#define ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2     (3)
#define ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3     (4)
#define ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4     (5)
#define ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM5     (6)
#define ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN           (7)
#define ID_RANDOM_CAVE_CONTAINER_SPAWN                (8)
#define ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1          (9)
#define ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2          (10)
#define ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3          (11)
#define ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4          (12)
#define ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5          (13)
#define ID_RANDOM_CAVE_TRAPS_EXIT_0                   (14)
#define ID_RANDOM_CAVE_TRAPS_EXIT_1                   (15)
#define ID_RANDOM_CAVE_TRAPS_EXIT_2                   (16)
#define ID_RANDOM_CAVE_TRAPS_EXIT_3                   (17)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_0                (18)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_1                (19)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_2                (20)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_3                (21)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_4                (22)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_5                (23)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_6                (24)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_7                (25)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_8                (26)
#define ID_RANDOM_CAVE_TRAPS_CENTRAL_9                (27)
#define ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1          (28)
#define ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2          (29)
#define ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3          (30)
#define ID_RANDOM_CAVE_NEST_1                         (31)
#define ID_RANDOM_CAVE_NEST_2                         (32)
#define ID_RANDOM_CAVE_NEST_3                         (33)
#define ID_RANDOM_CAVE_NEST_4                         (34)
#define ID_RANDOM_CAVE_NEST_5                         (35)
#define ID_RANDOM_CAVE_MONSTER                        (36)
#define ID_RANDOM_CAVE_STORAGE_1                      (37)
#define ID_RANDOM_CAVE_STORAGE_2                      (38)
#define ID_RANDOM_CAVE_STORAGE_3                      (39)
#define ID_RANDOM_CAVE_PORTAL                         (40)
#define ID_EVENT_MONSTERS                             (41)

//Sierra caves L1
#define SIERRA_CAVES_L1_DUNGEON_ID                    (1)

#define SCL1_STATIC_CRITTER_SPAWN_ALL_CHANCE          (35)
#define SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE         (75)
#define SCL1_PATROL_CRITTER_SPAWN_CHANCE              (65)
#define SCL1_GROUP_CRITTER_SPAWN_CHANCE               (4)
#define SCL1_CRITTER_NEST_SPAWN_CHANCE                (6)
#define SCL1_LOCKER_SPAWN_ROOM_CHANCE                 (20)
#define SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE             (4)
#define SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE          (8)
#define SCL1_MONSTER_SPAWN_CHANCE                     (10)
#define SCL1_STORAGE_SPAWN_CHANCE                     (4)
#define SCL1_PORTAL_SPAWN_CHANCE                      (25)

//Sierra caves L2
#define SIERRA_CAVES_L2_DUNGEON_ID                    (2)

#define SCL2_STATIC_CRITTER_SPAWN_ALL_CHANCE          (35)
#define SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE         (75)
#define SCL2_PATROL_CRITTER_SPAWN_CHANCE              (65)
#define SCL2_GROUP_CRITTER_SPAWN_CHANCE               (5)
#define SCL2_CRITTER_NEST_SPAWN_CHANCE                (7)
#define SCL2_LOCKER_SPAWN_ROOM_CHANCE                 (22)
#define SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE             (5)
#define SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE          (10)
#define SCL2_MONSTER_SPAWN_CHANCE                     (15)
#define SCL2_STORAGE_SPAWN_CHANCE                     (5)
#define SCL2_PORTAL_SPAWN_CHANCE                      (20)

//Sierra caves event
#define SIERRA_CAVES_EVENT_TB_DUNGEON_ID              (3)
#define SIERRA_CAVES_EVENT_RT_DUNGEON_ID              (4)

#define SCEVENT_LOCKER_SPAWN_ROOM_CHANCE              (25)
#define SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE          (2)
#define SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE       (4)
#define SCEVENT_STORAGE_SPAWN_CHANCE                  (6)


//--------------------------------------------------
//Random maps definition
//Sierra caves L1
RandomMapDefinition mapSierraCaveL11 = RandomMapDefinition(MAP_RandomCave1, SIERRA_CAVES_L1_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL1ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2, SIERRA_CAVES_L2_DUNGEON_ID, true), SCL1_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_H3, RANDOM_DUNGEON_STORAGE_3), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL1_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL1_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL1_CRITTER_NEST_SPAWN_CHANCE) //Room4
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL1_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL1_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL1_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL1_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_NEST_2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1);

RandomMapDefinition mapSierraCaveL12 = RandomMapDefinition(MAP_RandomCave2, SIERRA_CAVES_L1_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL1ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2,  SIERRA_CAVES_L2_DUNGEON_ID,true), SCL1_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_H2, RANDOM_DUNGEON_STORAGE_2), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL1_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL1_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL1_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL1_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL1_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_3), SCL1_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL1_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL1_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2);
	
RandomMapDefinition mapSierraCaveL13 = RandomMapDefinition(MAP_RandomCave3, SIERRA_CAVES_L1_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL1ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2, SIERRA_CAVES_L2_DUNGEON_ID, true), SCL1_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL1_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL1_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL1_CRITTER_NEST_SPAWN_CHANCE) //Room3
	.AddFeature(ID_RANDOM_CAVE_NEST_3, CrittersNest(RANDOM_DUNGEON_NEST_3), SCL1_CRITTER_NEST_SPAWN_CHANCE) //Room2
	.AddFeature(ID_RANDOM_CAVE_NEST_4, CrittersNest(RANDOM_DUNGEON_NEST_4), SCL1_CRITTER_NEST_SPAWN_CHANCE) //Room4
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL1_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL1_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL1_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM5, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM5), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_9, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_9), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_9, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3);

RandomMapDefinition mapSierraCaveL14 = RandomMapDefinition(MAP_RandomCave4, SIERRA_CAVES_L1_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL1ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2, SIERRA_CAVES_L2_DUNGEON_ID, true), SCL1_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL1_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL1_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL1_CRITTER_NEST_SPAWN_CHANCE) //Room1
	.AddFeature(ID_RANDOM_CAVE_NEST_3, CrittersNest(RANDOM_DUNGEON_NEST_3), SCL1_CRITTER_NEST_SPAWN_CHANCE) //Room2
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL1_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL1_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_3), SCL1_GROUP_CRITTER_SPAWN_CHANCE)	//Room4
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL1_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL1_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM5, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM5), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM5), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_NEST_3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM5)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3);
	
RandomMapDefinition mapSierraCaveL15 = RandomMapDefinition(MAP_RandomCave5, SIERRA_CAVES_L1_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL1ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_3, SIERRA_CAVES_L2_DUNGEON_ID, true), SCL1_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3), SCL1_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL1_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL1_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL1_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_3, CrittersNest(RANDOM_DUNGEON_NEST_3), SCL1_CRITTER_NEST_SPAWN_CHANCE) //Room2
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL1_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL1_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_3), SCL1_GROUP_CRITTER_SPAWN_CHANCE)	//Room4
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL1_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL1_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL1_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL1_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_3, Traps(RANDOM_DUNGEON_TRAP_EXIT_3), SCL1_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCL1_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, RANDOM_DUNGEON_NEST_1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_NEST_3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3);

//Sierra caves L2
RandomMapDefinition mapSierraCaveL21 = RandomMapDefinition(MAP_RandomCave1, SIERRA_CAVES_L2_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL2ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2, SIERRA_CAVES_L1_DUNGEON_ID, false), SCL2_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_H3, RANDOM_DUNGEON_STORAGE_3), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL2_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL2_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL2_CRITTER_NEST_SPAWN_CHANCE) //Room4
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL2_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL2_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL2_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL2_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_NEST_2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1);

RandomMapDefinition mapSierraCaveL22 = RandomMapDefinition(MAP_RandomCave2, SIERRA_CAVES_L2_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL2ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2, SIERRA_CAVES_L1_DUNGEON_ID, false), SCL2_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_H2, RANDOM_DUNGEON_STORAGE_2), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL2_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL2_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL2_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL2_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL2_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_3), SCL2_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL2_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL2_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2);
	
RandomMapDefinition mapSierraCaveL23 = RandomMapDefinition(MAP_RandomCave3, SIERRA_CAVES_L2_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL2ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2, SIERRA_CAVES_L1_DUNGEON_ID, false), SCL2_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL2_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL2_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL2_CRITTER_NEST_SPAWN_CHANCE) //Room3
	.AddFeature(ID_RANDOM_CAVE_NEST_3, CrittersNest(RANDOM_DUNGEON_NEST_3), SCL2_CRITTER_NEST_SPAWN_CHANCE) //Room2
	.AddFeature(ID_RANDOM_CAVE_NEST_4, CrittersNest(RANDOM_DUNGEON_NEST_4), SCL2_CRITTER_NEST_SPAWN_CHANCE) //Room4
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL2_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL2_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL2_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM5, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM5), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_9, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_9), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_9, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3);

RandomMapDefinition mapSierraCaveL24 = RandomMapDefinition(MAP_RandomCave4, SIERRA_CAVES_L2_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL2ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_2, SIERRA_CAVES_L1_DUNGEON_ID, false), SCL2_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL2_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL2_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL2_CRITTER_NEST_SPAWN_CHANCE) //Room1
	.AddFeature(ID_RANDOM_CAVE_NEST_3, CrittersNest(RANDOM_DUNGEON_NEST_3), SCL2_CRITTER_NEST_SPAWN_CHANCE) //Room2
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL2_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL2_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_3), SCL2_GROUP_CRITTER_SPAWN_CHANCE)	//Room4
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL2_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL2_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM5, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM5), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM5), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_NEST_3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM5)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3);
	
RandomMapDefinition mapSierraCaveL25 = RandomMapDefinition(MAP_RandomCave5, SIERRA_CAVES_L2_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesL2ContextFactory())
	.AddFeature(ID_RANDOM_CAVE_PORTAL, DungeonPortal(RANDOM_DUNGEON_PORTAL_0, RANDOM_DUNGEON_PORTAL_3, SIERRA_CAVES_L1_DUNGEON_ID, false), SCL2_PORTAL_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3), SCL2_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_MONSTER, Monster(), SCL2_MONSTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_1, CrittersNest(RANDOM_DUNGEON_NEST_1), SCL2_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_2, CrittersNest(RANDOM_DUNGEON_NEST_2), SCL2_CRITTER_NEST_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_NEST_3, CrittersNest(RANDOM_DUNGEON_NEST_3), SCL2_CRITTER_NEST_SPAWN_CHANCE) //Room2
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_1, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_1), SCL2_GROUP_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_2, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_2), SCL2_GROUP_CRITTER_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3, GroupCritters(RANDOM_DUNGEON_GROUP_CENTER_3), SCL2_GROUP_CRITTER_SPAWN_CHANCE)	//Room4
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN, PatrolCritters(), SCL2_PATROL_CRITTER_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ALL, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN), SCL2_STATIC_CRITTER_SPAWN_ALL_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM1), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM2), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM3, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM3), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4, StaticCritters(RANDOM_DUNGEON_CRITTER_SPAWN_ROOM4), SCL2_STATIC_CRITTER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4), SCL2_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_3, Traps(RANDOM_DUNGEON_TRAP_EXIT_3), SCL2_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCL2_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_CONTAINER_SPAWN, ID_RANDOM_CAVE_PATROL_CRITTER_SPAWN)
	.AddExcludingRule(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, RANDOM_DUNGEON_NEST_1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_NEST_3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_STATIC_CRITTER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_GROUP_CRITTER_SPAWN_3);

//Sierra caves event TB
RandomMapDefinition mapSierraCaveEventTB1 = RandomMapDefinition(MAP_RandomCave1, SIERRA_CAVES_EVENT_TB_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_H3, RANDOM_DUNGEON_STORAGE_3, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1);

RandomMapDefinition mapSierraCaveEventTB2 = RandomMapDefinition(MAP_RandomCave2, SIERRA_CAVES_EVENT_TB_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_H2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2);
	
RandomMapDefinition mapSierraCaveEventTB3 = RandomMapDefinition(MAP_RandomCave3, SIERRA_CAVES_EVENT_TB_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_9, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_9), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3);

RandomMapDefinition mapSierraCaveEventTB4 = RandomMapDefinition(MAP_RandomCave4, SIERRA_CAVES_EVENT_TB_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM5, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5);
	
RandomMapDefinition mapSierraCaveEventTB5 = RandomMapDefinition(MAP_RandomCave5, SIERRA_CAVES_EVENT_TB_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_3, Traps(RANDOM_DUNGEON_TRAP_EXIT_3), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4);

//Sierra caves event RT
RandomMapDefinition mapSierraCaveEventRT1 = RandomMapDefinition(MAP_RandomCave1, SIERRA_CAVES_EVENT_RT_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_H3, RANDOM_DUNGEON_STORAGE_3, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1);

RandomMapDefinition mapSierraCaveEventRT2 = RandomMapDefinition(MAP_RandomCave2, SIERRA_CAVES_EVENT_RT_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_H2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)	
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2);
	
RandomMapDefinition mapSierraCaveEventRT3 = RandomMapDefinition(MAP_RandomCave3, SIERRA_CAVES_EVENT_RT_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_8, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_8), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_9, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_9), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3);

RandomMapDefinition mapSierraCaveEventRT4 = RandomMapDefinition(MAP_RandomCave4, SIERRA_CAVES_EVENT_RT_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM5, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM5);
	
RandomMapDefinition mapSierraCaveEventRT5 = RandomMapDefinition(MAP_RandomCave5, SIERRA_CAVES_EVENT_RT_DUNGEON_ID)
	.SetRandomMapContextFactory(SierraCavesEventContextFactory())
	.AddFeature(ID_EVENT_MONSTERS, EventMonsters(), 100)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_1, Storage(RANDOM_DUNGEON_WALL_BE_V1, RANDOM_DUNGEON_STORAGE_1, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_2, Storage(RANDOM_DUNGEON_WALL_BE_V2, RANDOM_DUNGEON_STORAGE_2, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_STORAGE_3, Storage(RANDOM_DUNGEON_WALL_BE_V3, RANDOM_DUNGEON_STORAGE_3, false, false), SCEVENT_STORAGE_SPAWN_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN, LootContainer(RANDOM_DUNGEON_CONTAINER_H, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM1, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM2, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM3, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM3, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4, LootContainer(RANDOM_DUNGEON_CONTAINER_H_ROOM4, false), SCEVENT_LOCKER_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_0, Traps(RANDOM_DUNGEON_TRAP_EXIT_0), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_1, Traps(RANDOM_DUNGEON_TRAP_EXIT_1), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_2, Traps(RANDOM_DUNGEON_TRAP_EXIT_2), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_EXIT_3, Traps(RANDOM_DUNGEON_TRAP_EXIT_3), SCEVENT_TRAPS_EXIT_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_0, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_0), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_1, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_1), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_2, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_2), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_3, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_3), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_4, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_4), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_5, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_5), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_6, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_6), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddFeature(ID_RANDOM_CAVE_TRAPS_CENTRAL_7, Traps(RANDOM_DUNGEON_TRAP_CENTRAL_7), SCEVENT_TRAPS_CENTRAL_SPAWN_ROOM_CHANCE)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_1, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM2)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_2, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM1)
	.AddExcludingRule(ID_RANDOM_CAVE_STORAGE_3, ID_RANDOM_CAVE_CONTAINER_SPAWN_ROOM4);
	
//--------------------------------------------------
//Context factories definition

uint16[] Pids_TreasureLow = {PID_BPACK_TENT, PID_LIGHTER, PID_10MM_SMG, PID_GREASE_GUN, PID_SCOPED_HUNTING_RIFLE, PID_44_MAGNUM_SPEEDLOADER, PID_SAWED_OFF_SHOTGUN, PID_FRAG_GRENADE, PID_COMBAT_KNIFE, PID_LEATHER_ARMOR, PID_METAL_ARMOR, PID_PURPLE_ROBE, PID_DESERT_EAGLE_EXT_MAG, PID_SHOVEL, PID_COMBAT_SHOTGUN, PID_14MM_PISTOL, PID_METAL_TRASH, PID_GUNPOWDER};
uint16[] Pids_TreasureMid = {PID_GUNS_AND_BULLETS, PID_SCOUT_HANDBOOK, PID_FIRST_AID_BOOK, PID_DEANS_ELECTRONICS, PID_BIG_BOOK_OF_SCIENCE, PID_DOCTORS_BAG, PID_RIPPER, PID_PLASMA_GRENADE, PID_PLASMA_PISTOL_EXT_CART, PID_LASER_RIFLE_EXT_CAP, PID_IMPROVED_FLAMETHROWER, PID_METAL_ARMOR_MK_II, PID_NEEDLER_PISTOL, PID_223_PISTOL, PID_ASSAULT_RIFLE_EXT_MAG, PID_MINIGUN, PID_KEVLAR_POLYMER, PID_HIGH_GRADE_STEEL, PID_CHEMICAL_COMPONENTS, PID_ENERGY_TRANSFORMER};
uint16[] Pids_TreasureHigh = {PID_NECKLACE, PID_MAGIC_8_BALL, PID_GOLD_LOCKET, PID_FUZZY_PAINTING, PID_DAISIES, PID_MIRROR_SHADES, PID_SPECTACLES ,PID_HEART_PILLS, PID_MARKED_DECK_OF_CARDS, PID_DECK_OF_CARDS, PID_LOADED_DICE, PID_DICE, PID_COSMETIC_CASE, PID_RED_CONDOM, PID_GREEN_CONDOM, PID_BLUE_CONDOM, PID_MOTION_SENSOR, PID_STEALTH_BOY, PID_GEIGER_COUNTER, PID_BIO_GEL, PID_ELEC_LOCKPICK_MKII, PID_ELECTRONIC_LOCKPICKS, PID_SUPER_TOOL_KIT, PID_GOLD_TOOTH, PID_YELLOW_PASS_KEY, PID_BLUE_PASS_KEY, PID_RED_PASS_KEY, PID_COOKIE, PID_HYPO, PID_JET_ANTIDOTE, PID_PLATED_BOXING_GLOVES, PID_BOXING_GLOVES, PID_SUPER_CATTLE_PROD, PID_WAKIZASHI_BLADE, PID_ELI_KNIFE, PID_LOUISVILLE_SLUGGER, PID_YK32_PULSE_PISTOL, PID_SOLAR_SCORCHER, PID_HK_P90C, PID_SNIPER_RIFLE, PID_BLACK_ROBE, PID_COMBAT_ARMOR, PID_COMBAT_ARMOR_MK_II, PID_MEGA_POWER_FIST, PID_PLASMA_RIFLE, PID_LIGHT_SUPPORT_WEAPON, PID_AVENGER_MINIGUN, PID_XL70E3};
uint16[] Pids_RareMaps = {PID_Rare_Base_Scrapheap, PID_Rare_Base_Cave, PID_Rare_Base_Depot, PID_Rare_Base_Gasstation, PID_Rare_Base_Tents, PID_Rare_Base_Cave2, PID_Rare_Base_Camp};
uint16[] Pids_Lockpicks = {PID_LOCKPICKS, PID_LOCKPICKS, PID_LOCKPICKS, PID_EXP_LOCKPICK_SET};
uint16[] Pids_AmmoL1 = {PID_7_62MM_AMMO, PID_5MM_AP, PID_5MM_JHP, PID_14MM_AP, PID_SMALL_ENERGY_CELL, PID_223_FMJ, PID_SHOTGUN_SHELLS, PID_45_CALIBER_AMMO, PID_SMALL_ENERGY_CELL, PID_10MM_JHP, PID_10MM_AP, PID_MICRO_FUSION_CELL};
uint16[] Pids_AmmoL2 = {PID_7_62MM_AMMO, PID_5MM_AP, PID_14MM_AP, PID_SMALL_ENERGY_CELL, PID_223_FMJ, PID_45_CALIBER_AMMO, PID_10MM_AP, PID_MICRO_FUSION_CELL, PID_SLUG_SHELLS};
uint16[] Pids_Drugs = {PID_JET, PID_BUFFOUT, PID_MENTATS, PID_SUPER_STIMPAK, PID_RAD_X, PID_RADAWAY, PID_JET, PID_BUFFOUT, PID_MENTATS, PID_SUPER_STIMPAK, PID_RAD_X, PID_RADAWAY, PID_PSYCHO};
uint16[] Pids_BlueprintsL1 = {BLUEPRINT_LEVEL1, BLUEPRINT_LEVEL2, BLUEPRINT_LEVEL3};
uint16[] Pids_BlueprintsL2 = {BLUEPRINT_LEVEL2, BLUEPRINT_LEVEL3};
uint16[] Pids_Recipies = {PID_PLASMA_RIFLE_RECIPE, PID_PLASMA_GRENADE_RECIPE, PID_AVENGER_MINIGUN_RECIPE,
		PID_SNIPER_RIFLE_RECIPE, PID_XL70E3_RECIPE, PID_HK_P90C_RECIPE, PID_HUBOLOGIST_ROBE_RECIPE, PID_LASER_RIFLE_EXT_CAP_RECIPE,
		PID_LIGHT_SUPPORT_WEAPON_RECIPE};
uint16[] Pids_Prewar = {PID_MPART_1, PID_MPART_2, PID_MPART_3, PID_MPART_4, PID_EPART_1, PID_EPART_2, PID_EPART_3, PID_EPART_4, PID_EPART_5, PID_PREWAR_1, PID_PREWAR_2, PID_PREWAR_3};
uint16[] Pids_L2Rare = {PID_PARTICLE_ACCELERATOR, PID_EMISSION_CONCENTRATOR, PID_TITANIUM_BARRELS, PID_RECOIL_COMPENSATOR, PID_TELESCOPIC_SIGHTS, PID_ROTARY_CHAMBER, PID_BOLT_ASSIST, PID_ELECTRONIC_FIRE_MECHANISM, PID_MACHINED_HIGH_GRADE_STEEL, PID_HIFLO_HYDRAULIC,
				PID_IMPLANT_CHEMCONTROL, PID_IMPLANT_SCOUT, PID_IMPLANT_ENCHACEMENT, PID_IMPLANT_ENVIRONMENTAL, PID_IMPLANT_ACCURACY, PID_IMPLANT_DEFENCE, PID_IMPLANT_MEDIC, PID_IMPLANT_SPEED, PID_IMPLANT_SURVIVOR, PID_IMPLANT_MARKSMAN,
				PID_GENERAL_CLIFTONS_HOLODISK};


//Sierra caves L1
class SierraCavesL1ContextFactory : RandomMapContextFactory
{	
	RandomMapContext@ CreateRandomMapContext()
	{
		int critterType = ComputeCritterType();
		int critterSpawnRate = ComputeCritterSpawnRate(critterType);
		int trapPid = ComputeTrapType(critterSpawnRate);
		
		return SierraCavesL1ContextImpl(critterType, critterSpawnRate, trapPid);
	}
	
	private int ComputeCritterSpawnRate(int critterType)
	{
		int roll = Random(0, 100);
		int critterSpawnRate;
		
		if (roll < 50) 
		{
			critterSpawnRate = 10;
		} 
		else if (roll < 80)
		{
			critterSpawnRate = 30;
		}
		else
		{
			critterSpawnRate = 50;
		}
		
		if (IsHumanCritterType(critterType))
		{
			critterSpawnRate = critterSpawnRate / 2 + 5;
		}
		
		return critterSpawnRate;
	}
	
	private int ComputeCritterType()
	{
		int critterType;
		int roll = Random(0, 100);
		
		if (roll < 80) 
		{
			critterType = Random(CRITTER_TYPE_RAT, CRITTER_TYPE_GECKO);
		}
		else
		{
			critterType = Random(CRITTER_TYPE_HIGHWAYMEN, CRITTER_TYPE_PUNKER);
		}
		
		return critterType; 
	}
	
	private int ComputeTrapType(int critterSpawnRate)
	{
		int trapPid;
		int roll = Random(0, 100);
		
		if (critterSpawnRate >= 50)
		{
			trapPid = 0;
		}
		else if (roll < 40) 
		{
			trapPid = PID_ACTIVE_MINE;
		}
		else
		{
			trapPid = PID_BEAR_TRAP;
		}
		
		return trapPid;
	}
}

class SierraCavesL1ContextImpl : RandomMapContext
{
	private int critterType;
	private int critterSpawnRate;
	private int trapPid;

	SierraCavesL1ContextImpl(int critterType, int critterSpawnRate, int trapPid)
	{
		this.critterType = critterType;
		this.critterSpawnRate = critterSpawnRate;
		this.trapPid = trapPid; 
	}
	
	int GetCritterType()
	{
		return critterType;
	}
	
	int GetCritterSpawnRate()
	{
		return critterSpawnRate;
	}
	
	int GetTrapPid()
	{
		return trapPid;
	}
	
	void AddLoot(Item& container, int lootType, int rollMin, int rollMax)
	{
		if (lootType == LOOT_TYPE_REGULAR)
		{
			AddRegularLoot(container, rollMin, rollMax);
		}
		else if (lootType == LOOT_TYPE_STORAGE)
		{
			AddStorageLoot(container);
		}
	}
	
	private void AddRegularLoot(Item& container, int rollMin, int rollMax)
	{
		int roll = Random(rollMin, rollMax);
					
		if (roll < 10)
		{
			FillBagAllowRare(container, Pids_TreasureLow, 25, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 5, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 1, 1, 1);
			FillBagAllowRare(container, Pids_Drugs, 2, 1, 1);
			FillBagAllowRare(container, Pids_AmmoL1, 5, 20, 100);
			FillBag(container, Pids_Lockpicks, 5, 1, 1);
			FillBag(container, PID_BOTTLE_CAPS, 95, 20, 120);
			FillBag(container, PID_STIMPAK, 5, 1, 4);
			FillBag(container, Pids_BlueprintsL1, 25, 1, 1);
		}
		else if (roll < 95)
		{
			FillBagAllowRare(container, Pids_TreasureLow, 30, 1, 1);
			FillBagAllowRare(container, Pids_TreasureLow, 20, 1, 1);
			FillBagAllowRare(container, Pids_TreasureLow, 10, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 10, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 5, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 2, 1, 1);
			FillBagAllowRare(container, Pids_Drugs, 5, 3, 3);
			FillBagAllowRare(container, Pids_AmmoL1, 10, 40, 200);
			FillBagAllowRare(container, Pids_AmmoL1, 5, 40, 200);
			FillBag(container, Pids_Lockpicks, 10, 1, 1);
			FillBagAllowRare(container, PID_4_7MM_CASELESS, 1, 6, 16);
			FillBagAllowRare(container, PID_2MM_EC_AMMO, 1, 3, 6);
			FillBagAllowRare(container, PID_BOTTLE_CAPS, 95, 30, 180);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 10, 2, 4);
			FillBag(container, Pids_Prewar, 1, 1, 1);
			FillBag(container, Pids_BlueprintsL1, 50, 1, 1);
		}
		else
		{		
			FillBagAllowRare(container, Pids_TreasureLow, 40, 1, 1);
			FillBagAllowRare(container, Pids_TreasureLow, 30, 1, 1);
			FillBagAllowRare(container, Pids_TreasureLow, 20, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 20, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 10, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 5, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 10, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 1, 1, 1);
			FillBagAllowRare(container, Pids_Drugs, 30, 3, 3);
			FillBagAllowRare(container, Pids_Drugs, 15, 3, 3);
			FillBagAllowRare(container, Pids_AmmoL1, 20, 60, 300);
			FillBagAllowRare(container, Pids_AmmoL1, 10, 60, 300);
			FillBagAllowRare(container, Pids_AmmoL1, 5, 60, 300);
			FillBag(container, Pids_Lockpicks, 20, 1, 1);
			FillBagAllowRare(container, PID_4_7MM_CASELESS, 1, 12, 32);
			FillBagAllowRare(container, PID_2MM_EC_AMMO, 1, 6, 12);
			FillBagAllowRare(container, PID_BOTTLE_CAPS, 95, 30, 180);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 20, 2, 4);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 10, 2, 4);
			FillBag(container, Pids_Prewar, 1, 1, 1);
			FillBag(container, Pids_BlueprintsL1, 75, 1, 1);
		}
	}
	
	private void AddStorageLoot(Item& container)
	{
		int count = HAS_CHANCE(5) ? Random(5, 8) * 100 : Random(3, 4) * 100;
		
		FillBag(container, Pids_AmmoL1, 100, count, count);
		FillBag(container, PID_FRAG_GRENADE, 1, 5, 10);
		FillBag(container, PID_PLASMA_GRENADE, 1, 5, 10);
	}
}

//Sierra caves L2
class SierraCavesL2ContextFactory : RandomMapContextFactory
{	
	RandomMapContext@ CreateRandomMapContext()
	{
		int critterType = ComputeCritterType();
		int critterSpawnRate = ComputeCritterSpawnRate(critterType);
		int trapPid = ComputeTrapType(critterSpawnRate);
		
		return SierraCavesL2ContextImpl(critterType, critterSpawnRate, trapPid);
	}
	
	private int ComputeCritterSpawnRate(int critterType)
	{
		int roll = Random(0, 100);
		int critterSpawnRate;
		
		if (roll < 50) 
		{
			critterSpawnRate = 10;
		} 
		else if (roll < 80)
		{
			critterSpawnRate = 30;
		}
		else
		{
			critterSpawnRate = 50;
		}
		
		if (IsHumanCritterType(critterType))
		{
			critterSpawnRate = critterSpawnRate / 2 + 5;
		}
		
		return critterSpawnRate;
	}
	
	private int ComputeCritterType()
	{
		int critterType;
		int roll = Random(0, 100);
		
		if (roll < 80) 
		{
			critterType = Random(CRITTER_TYPE_GECKO, CRITTER_TYPE_DEATHCLAW);
		}
		else
		{
			critterType = Random(CRITTER_TYPE_RAIDER, CRITTER_TYPE_REGULATOR);
		}
		
		return critterType; 
	}
	
	private int ComputeTrapType(int critterSpawnRate)
	{
		int trapPid;
		int roll = Random(0, 100);
		
		if (critterSpawnRate >= 50)
		{
			trapPid = 0;
		}
		else if (roll < 40) 
		{
			trapPid = PID_ACTIVE_MINE;
		}
		else
		{
			trapPid = PID_BEAR_TRAP;
		}
		
		return trapPid;
	}
}

class SierraCavesL2ContextImpl : RandomMapContext
{
	private int critterType;
	private int critterSpawnRate;
	private int trapPid;

	SierraCavesL2ContextImpl(int critterType, int critterSpawnRate, int trapPid)
	{
		this.critterType = critterType;
		this.critterSpawnRate = critterSpawnRate;
		this.trapPid = trapPid; 
	}
	
	int GetCritterType()
	{
		return critterType;
	}
	
	int GetCritterSpawnRate()
	{
		return critterSpawnRate;
	}
	
	int GetTrapPid()
	{
		return trapPid;
	}
	
	void AddLoot(Item& container, int lootType, int rollMin, int rollMax)
	{
		if (lootType == LOOT_TYPE_REGULAR)
		{
			AddRegularLoot(container, rollMin, rollMax);
		}
		else if (lootType == LOOT_TYPE_STORAGE)
		{
			AddStorageLoot(container);
		}
	}
	
	private void AddRegularLoot(Item& container, int rollMin, int rollMax)
	{
		int roll = Random(rollMin, rollMax);
					
		if (roll < 10)
		{
			FillBagAllowRare(container, Pids_TreasureMid, 25, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 15, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 30, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 6, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 2, 1, 1);
			FillBagAllowRare(container, Pids_Drugs, 10, 2, 3);
			FillBagAllowRare(container, Pids_AmmoL2, 7, 20, 100);
			FillBag(container, Pids_Lockpicks, 5, 1, 1);
			FillBag(container, PID_BOTTLE_CAPS, 95, 20, 120);
			FillBag(container, PID_SUPER_STIMPAK, 5, 2, 5);
			FillBag(container, Pids_Prewar, 1, 1, 1);
			FillBag(container, Pids_BlueprintsL2, 25, 1, 1);
			FillBag(container, Pids_Recipies, 25, 1, 1);
		}
		else if (roll < 95)
		{
			FillBagAllowRare(container, Pids_TreasureMid, 35, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 25, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 30, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 15, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 10, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 5, 1, 1);
			FillBagAllowRare(container, Pids_Drugs, 15, 4, 5);
			FillBagAllowRare(container, Pids_Drugs, 1, 2, 3);
			FillBagAllowRare(container, Pids_AmmoL2, 15, 40, 200);
			FillBagAllowRare(container, Pids_AmmoL2, 10, 40, 200);
			FillBag(container, Pids_Lockpicks, 15, 1, 1);
			FillBagAllowRare(container, PID_4_7MM_CASELESS, 1, 10, 18);
			FillBagAllowRare(container, PID_2MM_EC_AMMO, 1, 6, 9);
			FillBagAllowRare(container, PID_BOTTLE_CAPS, 95, 30, 180);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 15, 4, 6);
			FillBag(container, Pids_Prewar, 1, 1, 1);
			FillBag(container, Pids_BlueprintsL2, 50, 1, 1);
			FillBag(container, Pids_Recipies, 50, 1, 1);
		}
		else
		{		
			FillBagAllowRare(container, Pids_TreasureMid, 45, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 35, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 35, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 30, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 25, 1, 1);
			FillBagAllowRare(container, Pids_TreasureMid, 15, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 15, 1, 1);
			FillBagAllowRare(container, Pids_TreasureHigh, 5, 1, 1);
			FillBagAllowRare(container, Pids_RareMaps, 1, 1, 1);
			FillBagAllowRare(container, Pids_Drugs, 35, 4, 6);
			FillBagAllowRare(container, Pids_Drugs, 20, 4, 6);
			FillBagAllowRare(container, Pids_AmmoL2, 25, 60, 300);
			FillBagAllowRare(container, Pids_AmmoL2, 15, 60, 300);
			FillBagAllowRare(container, Pids_AmmoL2, 7, 60, 300);
			FillBag(container, Pids_Lockpicks, 25, 1, 1);
			FillBagAllowRare(container, PID_4_7MM_CASELESS, 1, 18, 39);
			FillBagAllowRare(container, PID_2MM_EC_AMMO, 1, 8, 18);
			FillBagAllowRare(container, PID_BOTTLE_CAPS, 95, 30, 180);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 30, 4, 6);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 15, 4, 6);
			FillBag(container, Pids_Prewar, 1, 1, 1);
			FillBag(container, Pids_BlueprintsL2, 75, 1, 1);
			FillBag(container, Pids_Recipies, 75, 1, 1);
			FillBag(container, Pids_L2Rare, 50, 1, 1);
		}
	}
	
	private void AddStorageLoot(Item& container)
	{
		if (HAS_CHANCE(5))
		{
			FillBagAllowRare(container, Pids_Drugs, 95, 3, 5);
			FillBagAllowRare(container, Pids_Drugs, 90, 3, 5);
			FillBagAllowRare(container, Pids_Drugs, 85, 3, 5);
			FillBagAllowRare(container, Pids_Drugs, 80, 3, 5);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 90, 5, 7);
			FillBagAllowRare(container, PID_SUPER_STIMPAK, 80, 5, 7);
			FillBag(container, PID_DOCTORS_BAG, 95, 1, 1);
			FillBag(container, PID_FIRST_AID_KIT, 95, 1, 1);
			FillBag(container, PID_FIELD_MEDIC_KIT, 5, 1, 1);
			FillBag(container, PID_PARAMEDICS_BAG, 5, 1, 1);
		}
		else
		{
			int count = HAS_CHANCE(5) ? Random(5, 8) * 100 : Random(3, 4) * 100;
			FillBag(container, Pids_AmmoL2, 100, count, count);
			FillBag(container, PID_PLASMA_GRENADE, 5, 5, 10);
			FillBag(container, PID_FRAG_GRENADE, 5, 5, 10);
			FillBag(container, PID_PLASMA_GRENADE, 1, 10, 20);
			FillBag(container, PID_FRAG_GRENADE, 1, 10, 20);
		}
	}
}

//Sierra caves event
class SierraCavesEventContextFactory : RandomMapContextFactory
{	
	RandomMapContext@ CreateRandomMapContext()
	{
		int trapPid = ComputeTrapType();
		
		return SierraCavesEventContextImpl(trapPid);
	}
		
	private int ComputeTrapType()
	{
		int trapPid;
		int roll = Random(0, 100);
		
		if (roll < 50)
		{
			trapPid = 0;
		}
		else if (roll < 75) 
		{
			trapPid = PID_ACTIVE_MINE;
		}
		else
		{
			trapPid = PID_BEAR_TRAP;
		}
		
		return trapPid;
	}
}


class SierraCavesEventContextImpl : RandomMapContext
{
	private int trapPid;

	SierraCavesEventContextImpl(int trapPid)
	{
		this.trapPid = trapPid; 
	}
	
	int GetCritterType()
	{
		return CRITTER_TYPE_DEATHCLAW;
	}
	
	int GetCritterSpawnRate()
	{
		return 0;
	}
	
	int GetTrapPid()
	{
		return trapPid;
	}
	
	void AddLoot(Item& container, int lootType, int rollMin, int rollMax)
	{
		int progress = GetSCEventProgress();
		int[] tierBucketChance = {0, 0, 0, 0};
		int tierBucketChanceSum = 0;
		
		if (progress < 10)
		{
			tierBucketChance[0] = 10000;
			tierBucketChance[1] = progress;
		}
		
		if (progress >= 10 && progress < 20) {
			tierBucketChance[0] = 10000;
			tierBucketChance[1] = 10000;
			tierBucketChance[2] = progress - 10;			
		}
		
		if (progress >= 20 && progress < 30) {
			tierBucketChance[0] = 10000;
			tierBucketChance[1] = 10000;
			tierBucketChance[2] = 10000;
			tierBucketChance[3] = progress - 20;				
		}
		
		if (progress >= 30) {
			tierBucketChance[0] = 10000;
			tierBucketChance[1] = 10000;
			tierBucketChance[2] = 10000;
			tierBucketChance[3] = 1000;				
		}
	
		tierBucketChanceSum = tierBucketChance[0] + tierBucketChance[1] + tierBucketChance[2] + tierBucketChance[3];
	
		//Three rounds
		for (int i = 0; i < 4; i++)
		{
			int roll = Random(0, tierBucketChanceSum);
			int tierBucket = 0;
			
			for (int j = 0; j < 4; j++)
			{
				if (roll < tierBucketChance[j])
				{
					tierBucket = j;
					break;
				}
				else
				{
					roll -= tierBucketChance[j]; 
				}
			}

			if (lootType == LOOT_TYPE_REGULAR)
			{
				AddRegularLootBucket(container, tierBucket + 1);
			}
			else if (lootType == LOOT_TYPE_STORAGE)
			{
				AddStorageLootBucket(container, tierBucket + 1);
			}
		}
	}
	
	private void AddRegularLootBucket(Item& locker, int tier)
	{
		if (tier == 1)
		{
			FillBagOverride( locker, PID_LEATHER_JACKET, 			4,  1, 1 );
			FillBagOverride( locker, PID_LEATHER_ARMOR, 			2,  1, 1 );
			FillBagOverride( locker, PID_LEATHER_ARMOR_MK_II, 	    2,  1, 1 );
			FillBagOverride( locker, PID_CURED_LEATHER_ARMOR, 		4,  1, 1 );
			FillBagOverride( locker, PID_METAL_ARMOR, 		        2,  1, 1 );

			FillBagOverride( locker, PID_10MM_PISTOL, 				1,  1, 1 );
			FillBagOverride( locker, PID_DESERT_EAGLE, 			1,  1, 1 );
			FillBagOverride( locker, PID_DESERT_EAGLE_EXT_MAG, 	1,  1, 1 );
			FillBagOverride( locker, PID_44_MAGNUM_REVOLVER, 		1,  1, 1 );
			FillBagOverride( locker, PID_44_MAGNUM_SPEEDLOADER, 	1,  1, 1 );
			FillBagOverride( locker, PID_TOMMY_GUN, 				1,  1, 1 );
			FillBagOverride( locker, PID_10MM_SMG, 			    1,  1, 1 );
			FillBagOverride( locker, PID_HUNTING_RIFLE, 			1,  1, 1 );
			FillBagOverride( locker, PID_SCOPED_HUNTING_RIFLE, 	1,  1, 1 );
			FillBagOverride( locker, PID_SHOTGUN, 					1,  1, 1 );
			FillBagOverride( locker, PID_SAWED_OFF_SHOTGUN, 		1,  1, 1 );
			FillBagOverride( locker, PID_COMBAT_SHOTGUN, 			1,  1, 1 );
			FillBagOverride( locker, PID_GREASE_GUN, 				1,  1, 1 );
			FillBagOverride( locker, PID_FLAMER, 					1,  1, 1 );
			FillBagOverride( locker, PID_M60, 						1,  1, 1 );
			FillBagOverride( locker, PID_LASER_PISTOL, 			1,  1, 1 );
			FillBagOverride( locker, PID_MAGNETO_LASER_PISTOL, 	1,  1, 1 );
			
			FillBagOverride( locker, PID_MOLOTOV_COCKTAIL, 		1,  15, 40 );
			FillBagOverride( locker, PID_FRAG_GRENADE, 			1,  1, 15 );
			FillBagOverride( locker, PID_THROWING_KNIFE, 			2,  15, 40 );
			
			FillBagOverride( locker, PID_KNIFE, 					1,  1, 1 );
			FillBagOverride( locker, PID_COMBAT_KNIFE, 			1,  1, 1 );
			FillBagOverride( locker, PID_SPEAR, 					1,  1, 1 );
			FillBagOverride( locker, PID_SHARP_SPEAR, 				1,  1, 1 );
			FillBagOverride( locker, PID_CLUB, 					1,  1, 1 );
			FillBagOverride( locker, PID_CROWBAR, 					1,  1, 1 );
			FillBagOverride( locker, PID_WRENCH, 					1,  1, 1 );
			FillBagOverride( locker, PID_SLEDGEHAMMER, 			1,  1, 1 );
			FillBagOverride( locker, PID_BRASS_KNUCKLES, 			1,  1, 1 );
			FillBagOverride( locker, PID_SPIKED_KNUCKLES, 			1,  1, 1 );
			FillBagOverride( locker, PID_CATTLE_PROD, 				1,  1, 1 );
			
			FillBagOverride( locker, PID_7_62MM_AMMO, 				2,  1, 100 );
			FillBagOverride( locker, PID_9MM_AMMO, 				2,  1, 100 );
			FillBagOverride( locker, PID_9MM_BALL, 				2,  1, 100 );
			FillBagOverride( locker, PID_10MM_JHP, 				2,  1, 100 );
			FillBagOverride( locker, PID_10MM_AP, 					2,  1, 100 );
			FillBagOverride( locker, PID_44_MAGNUM_JHP, 			2,  1, 100 );
			FillBagOverride( locker, PID_44_FMJ_MAGNUM, 			2,  1, 100 );
			FillBagOverride( locker, PID_45_CALIBER_AMMO, 			2,  1, 100 );
			FillBagOverride( locker, PID_223_FMJ, 					2,  1, 100 );
			FillBagOverride( locker, PID_SHOTGUN_SHELLS, 			2,  1, 100 );
			FillBagOverride( locker, PID_FLAMETHROWER_FUEL, 		2,  1, 20 );
			FillBagOverride( locker, PID_SMALL_ENERGY_CELL, 		2,  1, 100 );
			
			FillBagOverride( locker, PID_JET, 						10,  1, 1 );
			FillBagOverride( locker, PID_CIGARETTES, 				10,  1, 1 );
			FillBagOverride( locker, PID_NUKA_COLA, 				10,  1, 1 );
			FillBagOverride( locker, PID_HEALING_POWDER, 			5,  1, 15 );
			FillBagOverride( locker, PID_STIMPAK, 					1,  1, 10 );
		}
		else if (tier == 2)
		{
			FillBagOverride( locker, PID_METAL_ARMOR_MK_II, 		1,  1, 1 );
			FillBagOverride( locker, PID_COMBAT_ARMOR, 			1,  1, 1 );
			FillBagOverride( locker, PID_TESLA_ARMOR, 			    1,  1, 1 );
			
			FillBagOverride( locker, PID_14MM_PISTOL, 			    1,  1, 1 );
			FillBagOverride( locker, PID_NEEDLER_PISTOL, 			1,  1, 1 );
			FillBagOverride( locker, PID_ASSAULT_RIFLE, 			1,  1, 1 );
			FillBagOverride( locker, PID_ASSAULT_RIFLE_EXT_MAG, 	1,  1, 1 );
			FillBagOverride( locker, PID_FN_FAL, 					1,  1, 1 );
			FillBagOverride( locker, PID_HK_CAWS, 					1,  1, 1 );
			FillBagOverride( locker, PID_IMPROVED_FLAMETHROWER, 	1,  1, 1 );
			FillBagOverride( locker, PID_ROCKET_LAUNCHER, 			1,  1, 1 );
			FillBagOverride( locker, PID_MINIGUN, 					1,  1, 1 );
			FillBagOverride( locker, PID_LIGHT_SUPPORT_WEAPON, 	1,  1, 1 );
			
			FillBagOverride( locker, PID_SUPER_SLEDGE, 			1,  1, 1 );
			FillBagOverride( locker, PID_SUPER_CATTLE_PROD, 		1,  1, 1 );
			FillBagOverride( locker, PID_RIPPER, 					1,  1, 1 );
			FillBagOverride( locker, PID_POWER_FIST, 				1,  1, 1 );
			
			FillBagOverride( locker, PID_14MM_AP, 					2,  1, 50 );
			FillBagOverride( locker, PID_EXPLOSIVE_ROCKET, 		2,  1, 15 );
			FillBagOverride( locker, PID_ROCKET_AP, 				2,  1, 15 );
			FillBagOverride( locker, PID_FLAMETHROWER_FUEL_MK_II, 	2,  1, 20 );
			FillBagOverride( locker, PID_5MM_JHP, 					2,  1, 200 );
			FillBagOverride( locker, PID_5MM_AP, 					2,  1, 300 );
			FillBagOverride( locker, PID_HN_NEEDLER_CARTRIDGE, 	2,  1, 50 );
			FillBagOverride( locker, PID_MICRO_FUSION_CELL, 		2,  1, 80 );
			
			FillBagOverride( locker, PID_BUFFOUT, 					8,  1, 1 );
			FillBagOverride( locker, PID_STIMPAK, 					5,  1, 10 );
			FillBagOverride( locker, PID_SUPER_STIMPAK, 			1,  1, 5 );
		}
		else if (tier == 3)
		{
			FillBagOverride( locker, PID_COMBAT_ARMOR_MK_II, 		1,  1, 1 );
			
			FillBagOverride( locker, PID_223_PISTOL, 			    1,  1, 1 );
			FillBagOverride( locker, PID_SNIPER_RIFLE, 			1,  1, 1 );
			FillBagOverride( locker, PID_XL70E3, 				1,  1, 1 );
			FillBagOverride( locker, PID_HK_P90C, 					1,  1, 1 );
			FillBagOverride( locker, PID_AVENGER_MINIGUN, 			1,  1, 1 );
			FillBagOverride( locker, PID_LASER_RIFLE, 				1,  1, 1 );
			FillBagOverride( locker, PID_LASER_RIFLE_EXT_CAP, 		1,  1, 1 );
			FillBagOverride( locker, PID_PLASMA_PISTOL, 			1,  1, 1 );
			FillBagOverride( locker, PID_PLASMA_PISTOL_EXT_CART, 	1,  1, 1 );
			FillBagOverride( locker, PID_PLASMA_RIFLE, 			1,  1, 1 );
			FillBagOverride( locker, PID_YK32_PULSE_PISTOL, 		1,  1, 1 );
			
			FillBagOverride( locker, PID_PLASMA_GRENADE, 			1,  1, 15 );
			
			FillBagOverride( locker, PID_MEGA_POWER_FIST, 			1,  1, 1 );
			
			FillBagOverride( locker, PID_HN_AP_NEEDLER_CARTRIDGE, 	2,  1, 50 );
			FillBagOverride( locker, PID_SLUG_SHELLS, 				2,  1, 100 );
			
			FillBagOverride( locker, PID_PSYCHO, 					0.1,  1, 1 );
			FillBagOverride( locker, PID_SUPER_STIMPAK, 			5,  1, 5 );
		}
		else if (tier == 4)
		{
			FillBagOverride( locker, PID_BROTHERHOOD_COMBAT_ARMOR, 1,  0, 1 );
			FillBagOverride( locker, PID_BLACK_COMBAT_ARMOR, 		1,  0, 1 );
			FillBagOverride( locker, PID_RANGER_ARMOR, 			1,  0, 1 );
			FillBagOverride( locker, PID_DESERT_CAMO_ARMOR, 		1,  0, 1 );
			FillBagOverride( locker, PID_NAVY_ARMOR, 			    1,  0, 1 );
			
			FillBagOverride( locker, PID_PK12_GAUSS_PISTOL, 		1,  0, 1 );
			FillBagOverride( locker, PID_M72_GAUSS_RIFLE, 			1,  0, 1 );
			FillBagOverride( locker, PID_HK_G11, 					1,  0, 1 );
			FillBagOverride( locker, PID_HK_G11E, 					1,  0, 1 );
			FillBagOverride( locker, PID_VINDICATOR_MINIGUN, 		1,  0, 1 );
			FillBagOverride( locker, PID_BOZAR, 					1,  0, 1 );
			FillBagOverride( locker, PID_SOLAR_SCORCHER, 			1,  0, 1 );
			FillBagOverride( locker, PID_GATLING_LASER, 			1,  0, 1 );
			FillBagOverride( locker, PID_ALIEN_LASER_PISTOL, 		1,  0, 1 );
			FillBagOverride( locker, PID_TURBO_PLASMA_RIFLE, 		1,  0, 1 );
			FillBagOverride( locker, PID_YK42B_PULSE_RIFLE, 		1,  0, 1 );
			
			FillBagOverride( locker, PID_LIL_JESUS_WEAPON, 		1,  1, 1 );
			FillBagOverride( locker, PID_WAKIZASHI_BLADE, 			1,  1, 1 );
			FillBagOverride( locker, PID_ELI_KNIFE, 				1,  1, 1 );
			FillBagOverride( locker, PID_LOUISVILLE_SLUGGER, 		1,  1, 1 );
			
			FillBagOverride( locker, PID_4_7MM_CASELESS, 			2,  1, 50 );
			FillBagOverride( locker, PID_50CAL, 					2,  1, 50 );
			FillBagOverride( locker, PID_2MM_EC_AMMO, 				2,  1, 25 );
			
			FillBagOverride( locker, PID_COOKIE, 					1,  1, 1 );
			FillBagOverride( locker, PID_HYPO, 					5,  1, 1 );
		}

		//MISC
		FillBagOverride( locker, PID_FIRST_AID_KIT, 			1,  1, 1 );
		FillBagOverride( locker, PID_FIELD_MEDIC_KIT, 			1,  1, 1 );
		FillBagOverride( locker, PID_DOCTORS_BAG, 				5,  1, 1 );
		FillBagOverride( locker, PID_PARAMEDICS_BAG, 			1,  1, 1 );
	}
	
	private void AddStorageLootBucket(Item& locker, int tier)
	{
		if (tier == 1)
		{			
			FillBagOverride( locker, PID_MOLOTOV_COCKTAIL, 		2,  15, 40 );
			FillBagOverride( locker, PID_FRAG_GRENADE, 			2,  1, 15 );
			
			FillBagOverride( locker, PID_7_62MM_AMMO, 				4,  1, 100 );
			FillBagOverride( locker, PID_9MM_AMMO, 				4,  1, 100 );
			FillBagOverride( locker, PID_9MM_BALL, 				4,  1, 100 );
			FillBagOverride( locker, PID_10MM_JHP, 				4,  1, 100 );
			FillBagOverride( locker, PID_10MM_AP, 					4,  1, 100 );
			FillBagOverride( locker, PID_44_MAGNUM_JHP, 			4,  1, 100 );
			FillBagOverride( locker, PID_44_FMJ_MAGNUM, 			4,  1, 100 );
			FillBagOverride( locker, PID_45_CALIBER_AMMO, 			4,  1, 100 );
			FillBagOverride( locker, PID_223_FMJ, 					4,  1, 100 );
			FillBagOverride( locker, PID_SHOTGUN_SHELLS, 			4,  1, 100 );
			FillBagOverride( locker, PID_FLAMETHROWER_FUEL, 		4,  1, 20 );
			FillBagOverride( locker, PID_SMALL_ENERGY_CELL, 		4,  1, 100 );
			
			FillBagOverride( locker, PID_JET, 						20,  1, 1 );
			FillBagOverride( locker, PID_CIGARETTES, 				20,  1, 1 );
			FillBagOverride( locker, PID_NUKA_COLA, 				20,  1, 1 );
			FillBagOverride( locker, PID_HEALING_POWDER, 			10, 1, 15 );
			FillBagOverride( locker, PID_STIMPAK, 					2,  1, 10 );
		}
		else if (tier == 2)
		{						
			FillBagOverride( locker, PID_14MM_AP, 					4,  1, 50 );
			FillBagOverride( locker, PID_EXPLOSIVE_ROCKET, 		4,  1, 15 );
			FillBagOverride( locker, PID_ROCKET_AP, 				4,  1, 15 );
			FillBagOverride( locker, PID_FLAMETHROWER_FUEL_MK_II, 	4,  1, 20 );
			FillBagOverride( locker, PID_5MM_JHP, 					4,  1, 200 );
			FillBagOverride( locker, PID_5MM_AP, 					4,  1, 300 );
			FillBagOverride( locker, PID_HN_NEEDLER_CARTRIDGE, 	4,  1, 50 );
			FillBagOverride( locker, PID_MICRO_FUSION_CELL, 		4,  1, 80 );
			
			FillBagOverride( locker, PID_BUFFOUT, 					16,  1, 1 );
			FillBagOverride( locker, PID_STIMPAK, 					10,  1, 10 );
			FillBagOverride( locker, PID_SUPER_STIMPAK, 			2,  1, 5 );
		}
		else if (tier == 3)
		{	
			FillBagOverride( locker, PID_PLASMA_GRENADE, 			1,  1, 15 );
			
			FillBagOverride( locker, PID_HN_AP_NEEDLER_CARTRIDGE, 	2,  1, 50 );
			FillBagOverride( locker, PID_SLUG_SHELLS, 				2,  1, 100 );
			
			FillBagOverride( locker, PID_PSYCHO, 					0.1,  1, 1 );
			FillBagOverride( locker, PID_SUPER_STIMPAK, 			10,  1, 5 );
		}
		else if (tier == 4)
		{			
			FillBagOverride( locker, PID_4_7MM_CASELESS, 			4,  1, 50 );
			FillBagOverride( locker, PID_50CAL, 					4,  1, 50 );
			FillBagOverride( locker, PID_2MM_EC_AMMO, 				4,  1, 25 );
			
			FillBagOverride( locker, PID_COOKIE, 					2,  1, 1 );
			FillBagOverride( locker, PID_HYPO, 					10,  1, 1 );
		}
	}
}


//--------------------------------------------------